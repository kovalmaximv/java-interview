# NoSQL

- [Виды NoSQL](#виды-nosql)
- [SQL vs NoSQL](#sql-vs-nosql)
- [Когда выбирать Key-Value DB](#когда-выбирать-key-value-db)
- [Когда выбирать Column DB](#когда-выбирать-column-db)
- [Когда выбирать Document Oriented DB](#когда-выбирать-document-oriented-db)
- [CAP теорема](#cap-теорема)

## Виды NoSQL
1) Ключ-значение - Redis
2) Колоночное - В каждом блоке хранятся данные только из одной колонки - Cassandra
3) Документо-ориентированные - Mongo
4) Графовые - сетевая база данных, которая использует узлы и рёбра для отображения и хранения данных

## SQL vs NoSQL
Вообще сравнивать SQL с абстрактной NoSQL бессмысленно, потому что NoSQL бывает разных типов, но если очень хочется:
1) Схема данных: SQL-база данных имеет строгую схему данных, которая определяет типы данных и связи между таблицами.
   В NoSQL-базах данных нет строгой схемы данных.
2) Масштабируемость: SQL-базы данных имеют ограничения на масштабируемость, из-за чего они могут быть неэффективны в
   обработке большого количества данных. NoSQL-базы данных обладают большой масштабируемостью, из-за чего они могут
   обрабатывать большие объёмы данных.
3) Гибкость запросов: SQL имеет очень мощный язык запросов, что делает его лучшим выбором для сложных запросов,
   связанных с большим количеством таблиц. С другой стороны, NoSQL имеет простой язык запросов, который хорошо подходит
   для запросов, связанных с большим количеством данных.
4) Скорость обработки: Несмотря на то, что SQL обычно работает медленнее, чем NoSQL, его мощный язык запросов позволяет
   быстро обрабатывать сложные запросы. С другой стороны, NoSQL работает очень быстро с неструктурированными данными в
   больших объёмах.

Особенности SQL:
- SQL-базы данных имеют жёстко определённый формат хранения данных, что делает их наиболее подходящим выбором для представления сложных связанных данных;
- SQL имеет мощный язык запросов, который позволяет обрабатывать сложные запросы;
- SQL-базы данных обычно требуют больших затрат на обслуживание и настройку.

Особенности NoSQL:
- NoSQL-базы данных хранят данные в форме документов, что делает их лучшим выбором для хранения неструктурированных данных, таких как данные о социальных сетях и блогах;
- NoSQL имеет простой язык запросов, который позволяет быстро обрабатывать запросы на огромные объёмы неструктурированных данных;
- NoSQL-базы данных позволяют быстрее масштабировать и расширять базу данных.

## Когда выбирать Key-Value DB
Redis, Memcache  
**Плюсы**:
- Неструктурированные гибкие данные  
- **Быстрая скорость чтения (кэш)**  
- Хранение данных в ОЗУ  

**Минусы**:
- Не подходят для данных со сложной структурой или связями между собой
- Не поддерживаются ACID гарантии
- Нет сжатия данных и индексации (помимо ключа) -> не подходит для хранения большого количества данных

## Когда выбирать Column DB
Cassandra, HBase  
**Плюсы**:
- **Поддерживает хранение большого количества данных (легко шардируется)**
- Данные хранятся денормализовано для более быстрых запросов

**Минусы**:
- Поиск только по primary и partition key. Не поддерживается фильтрация, сортировка, и тд по остальным полям
- Не поддерживаются ACID гарантии

## Когда выбирать Document Oriented DB
MongoDB, CouchDB. Философия в том, чтобы не хранить данные в разных таблицах, а хранить данные в одном JSON 
(денормализация).  
**Плюсы**:
- Данные хранятся денормализовано (и более локально) для более быстрых запросов
- Гибкая схема данных
- Богатая поддержка индексов и сложных запросов
- Ближе к ООП разработке, поскольку данные уже хранятся как объекты

**Минусы**:
- Не подходит для хранения данных со сложными связями из-за слабой поддержки join
- Из-за денормализации плохая ссылочная целостность (потому что в каждом документе свой поддокумент, который нужно обновить)

## CAP теорема
В CAP говорится, что в распределенной системе возможно выбрать только 2 из 3-х свойств:
1) C (consistency) — согласованность. Каждое чтение даст вам самую последнюю запись.
2) A (availability) — доступность. Каждый узел (не упавший) всегда успешно выполняет запросы (на чтение и запись).
3) P (partition tolerance) — устойчивость к распределению. Даже если между некоторыми узлами нет связи, система продолжает работать.

Буква P в данном случае просто данность: не бывает CA систем, иначе они не надежны (не могут быть распределены).

Интересные детали:
1) Многие системы — просто P
2) В разработке выбор между AP и CP