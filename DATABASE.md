# Базы данных

### Что такое «реляционная модель данных»?
Реляционные базы данных – старейший тип до сих пор широко используемых БД общего назначения. Данные и связи между 
данными организованы с помощью таблиц. Каждый столбец в таблице имеет имя и тип. Каждая строка представляет отдельную 
запись или элемент данных в таблице, который содержит значения для каждого из столбцов.

Помимо реляционных есть еще иерархические и сетевые базы данных.

### Какие бывают ключи
**Простой ключ** состоит из одного атрибута (поля). **Составной** - из двух и более.

**Потенциальный ключ** - простой или составной ключ, который уникально идентифицирует каждую запись набора данных.

Из множества всех потенциальных ключей набора данных выбирают **первичный ключ**, все остальные ключи 
называют **альтернативными**.

### Что такое «первичный ключ» (primary key)? Каковы критерии его выбора?
**Первичный ключ** (primary key) - аттрибут или набор аттрибутов, однозначно идентифицирующий запись из таблицы.

Критерии выбора:
1) Занимает меньше места и/или имеет меньшее число аттрибутов
2) Сохраняет уникальность со временем

### Внешний ключ (foreign key)
**Внешний ключ** (foreign key) — подмножество атрибутов некоторой таблицы A, значения которых должны совпадать со 
значениями некоторого потенциального ключа некоторой таблицы B.

### Какие существуют нормальные формы?
1) Значения всех атрибутов атомарны
2) Все неключевые атрибуты зависят только от ключа целиком, а не от какой-то его части.
3) Все неключевые атрибуты не зависят друг от друга
4) Не содержатся независимые группы атрибутов, между которыми существует отношение «многие-ко-многим»
5) Каждая нетривиальная зависимость соединения определяется потенциальным ключом этого отношения.
6) Когда она неприводима, то есть не может быть подвергнута дальнейшей декомпозиции без потерь

### Какие существуют типы связей в базе данных?
1) Один к одному - любому значению атрибута А соответствует только одно значение атрибута В, и наоборот.  
   Каждый университет гарантированно имеет 1-го ректора: 1 университет → 1 ректор.
2) Один ко многим - любому значению атрибута А соответствует 0, 1 или несколько значений атрибута В.  
   В каждом университете есть несколько факультетов: 1 университет → много факультетов.
3) Многие ко многим - любому значению атрибута А соответствует 0, 1 или несколько значений атрибута В, и 
любому значению атрибута В соответствует 0, 1 или несколько значение атрибута А.  
   1 профессор может преподавать на нескольких факультетах, в то же время на 1-ом факультете может преподавать 
несколько профессоров: Несколько профессоров ↔ Несколько факультетов.

### Что такое «индексы»? Для чего их используют? В чём заключаются их преимущества и недостатки?
**Индекс** (index) — объект базы данных, создаваемый с целью повышения производительности выборки данных.

Преимущества:
+ ускорение поиска и сортировки по определенному полю или набору полей.
+ обеспечение уникальности данных.

Недостатки:
+ требование дополнительного места на диске и в оперативной памяти и чем больше/длиннее ключ, тем больше размер индекса.
+ замедление операций вставки, обновления и удаления записей, поскольку при этом приходится обновлять сами индексы.

### Когда использовать индексы?

Когда индексы использовать:
+ SELECT преобладает над INSERT
+ Данные уникальны

Когда индексы не использовать:
+ Часто вставляют и редко читают
+ Данные не вариантивны (например значения да/нет)
+ Часто встречается NULL

### Какие типы индексов существуют?
По структуре:
+ B-деревья
+ Хеши

По количественному составу:
+ Простой
+ Составной

### Что такое «транзакция»?
**Транзакция** - набор команд, которые приводят БД из одного согласованного состояние в другое.

### Назовите основные свойства транзакции ACID.
1) **Атомарность** (atomicity) гарантирует, что никакая транзакция не будет зафиксирована в системе частично. Будут 
либо выполнены все её подоперации, либо не выполнено ни одной.
2) **Согласованность** (consistency). Транзакция после завершения оставляет БД в согласованном состоянии.
3) **Изолированность** (isolation). Во время выполнения транзакции параллельные транзакции не должны оказывать влияние 
на её результат.
4) **Долговечность** (durability). Независимо от проблем на нижних уровнях (к примеру, обесточивание системы или сбои 
в оборудовании) изменения, сделанные успешно завершённой транзакцией, должны остаться сохранёнными после возвращения 
системы в работу.

### Какие проблемы могут возникать при параллельном доступе с использованием транзакций?
При параллельном выполнении транзакций возможны следующие проблемы:
1) Потерянное обновление (lost update) — при одновременном изменении одного блока данных разными транзакциями одно из 
изменений теряется;
2) Грязное чтение (dirty read) — чтение данных, добавленных или изменённых транзакцией, которая впоследствии не 
подтвердится (откатится);
3) Неповторяющееся чтение (non-repeatable read) — при повторном чтении в рамках одной транзакции ранее прочитанные 
данные оказываются изменёнными;
4) Фантомное чтение (phantom reads) - одна транзакция в ходе своего выполнения несколько раз выбирает множество 
записей по одним и тем же критериям. Другая транзакция в интервалах между этими выборками добавляет или удаляет записи 
или изменяет столбцы некоторых записей, используемых в критериях выборки первой транзакции, и успешно заканчивается. 
В результате получится, что одни и те же выборки в первой транзакции дают разные множества записей.

### Какие существуют уровни изолированности транзакций?
В порядке увеличения изолированности транзакций и, соответственно, надёжности работы с данными:
1) Чтение неподтверждённых данных (read uncommitted, dirty read) - чтение незафиксированных изменений как своей 
транзакции, так и параллельных транзакций. Нет гарантии, что данные, изменённые другими транзакциями, не будут 
в любой момент изменены в результате их отката, поэтому такое чтение является потенциальным источником ошибок. 
Невозможны потерянные изменения, возможны неповторяемое чтение и фантомы.
2) Чтение подтверждённых данных (read committed) - чтение всех изменений своей транзакции и зафиксированных изменений 
параллельных транзакций. Потерянные изменения и грязное чтение не допускается, возможны неповторяемое чтение и фантомы.
3) Повторяемость чтения (repeatable read) — чтение всех изменений своей транзакции, любые изменения, внесённые 
параллельными транзакциями после начала своей, недоступны. Потерянные изменения, грязное и неповторяемое чтение 
невозможны, возможны фантомы.
4) Упорядочиваемость (serializable) — результат параллельного выполнения сериализуемой транзакции с другими 
транзакциями должен быть логически эквивалентен результату их какого-либо последовательного выполнения. Проблемы 
синхронизации не возникают.